---
title: "Homework 5"
author: "Nathan Catalano and Brett Simmons"
date: "2023-03-01"
output: html_document
---

Group Members: Nathan Catalano and Brett Simmons

Github repository: https://github.com/BrettSimmons/Lab2


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
choco <- read.csv("https://ds202-at-isu.github.io/labs/data/choco.csv")
head(choco)
```
## Question set 1
###1 What is the overall number of chocolate bars rated?
There are 1,852 chocolate bars rated
```{r}
dim(choco)
```



### 2 How does the number of ratings depend on the year? Draw a bar chart of the number of reports.
```{r}
library(ggplot2)
ggplot(choco, aes(x=Review.Date))+geom_bar(aes(weight=Rating))
```
## Question set 2

### How are ratings distributed? Draw a histogram of ratings and describe it. Donâ€™t forget to mention outliers, if there are any.

```{r}
ggplot(choco, aes(x=Rating)) + geom_histogram(binwidth=.25)
```

### Do ratings depend on the cocoa percentage of a chocolate bar?
```{r}
ggplot(choco,aes(x=Cocoa.Pct, y = Rating)) + aes(group=Cocoa.Pct) + geom_boxplot()
```

### How do ratings compare across different company locations? Focus on the three locations with the most ratings:
```{r}
company_locations = table(choco$Company.Location)
sorted_locations = sort(company_locations, decreasing = TRUE)
top3_locations = head(sorted_locations,3)
top3_locations
ggplot(data = choco[choco$Company.Location %in% c("U.S.A.", "France", "Canada"), ], aes(x = Rating, y = Cocoa.Pct)) + aes(group=Cocoa.Pct) + geom_boxplot() + coord_flip() + 
  facet_wrap(~Company.Location)
```
### What Company has the highest average rating when only looking at companies at with 10+ entries?
```{r}
companies = table(choco$Company)
greater10_companies = which(companies > 10)
# ggplot(choco, aes(x = Rating, y = Company)) + aes(group=Company) + geom_boxplot()

# selected_values <- choco$Company[choco$Company %in% names(freq_table)[indices_greater_than_10]]

# Print the selected values
companies
```

